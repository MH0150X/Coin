<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invite Friends</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="material/css/styles.css">
    <link rel="stylesheet" href="material/css/st.css">
    <style>
        /* Additional styles for the new elements */
        .referral-stats {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .referral-list {
            max-height: 300px;
            overflow-y: auto;
            margin: 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 10px;
        }
        
        .referral-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .referral-item:last-child {
            border-bottom: none;
        }
        
        .reward-info {
            background-color: #e3f2fd;
            padding: 15px;
            margin: 15px;
            border-radius: 10px;
            text-align: center;
        }
    </style>
</head>
<body>
    
    <div class="reward-info">
        <h3>Earn with Friends!</h3>
        <p>Get 100 Miko for each friend who joins using your link</p>
        <p>Your friend gets 50 Miko when they join</p>
    </div>

    <div class="frens-invite">
        <div class="frens-invite-button">
            <input type="text" value="Generating your link..." id="link" readonly>
            <button id="copyButton">Copy Link</button>
        </div>
    </div>

    <div class="referral-stats">
        <h3>Your Referral Stats</h3>
        <div class="stat-item">
            <span>Total Referrals:</span>
            <span id="totalReferrals">0</span>
        </div>
        <div class="stat-item">
            <span>Earned Miko:</span>
            <span id="earnedMiko">0</span>
        </div>
    </div>

    <div class="referral-list-container">
        <h3 style="margin: 15px 15px 0 15px;">Your Referrals</h3>
        <div class="referral-list" id="referralList">
            <!-- Referral items will be added here dynamically -->
            <div class="no-referrals">No referrals yet. Share your link to earn!</div>
        </div>
    </div>

    <nav class="bottom-nav">
        <a href="home.html" class="nav-item">
            <i class="fas fa-home"></i>
            <span>HOME</span>
        </a>
        <a href="leaderboard.html" class="nav-item">
            <i class="fas fa-trophy"></i>
            <span>LEADERBOARD</span>
        </a>
        <a href="invite-friends.html" class="nav-item active">
            <i class="fas fa-user-friends"></i>
            <span>FRIENDS</span>
        </a>
        <a href="task.html" class="nav-item">
            <i class="fas fa-tasks"></i>
            <span>TASKS</span>
        </a>
        <a href="balance.html" class="nav-item">
            <i class="fas fa-wallet"></i>
            <span>BALANCE</span>
        </a>
    </nav>

    <script src="material/js/cojs.js"></script>
    <script src="material/js/scripts.js"></script>
    <script>
        // This would be replaced with actual Telegram Bot API calls
        document.addEventListener('DOMContentLoaded', function() {
            // Get the user's Telegram ID (this would come from your backend)
            const telegramUserId = getTelegramUserId(); // You need to implement this
            
            // Generate referral link
            const referralLink = `https://t.me/MikoC0inBot?start=${telegramUserId}`;
            document.getElementById('link').value = referralLink;
            
            // Set up copy button
            document.getElementById('copyButton').addEventListener('click', function() {
                const linkInput = document.getElementById('link');
                linkInput.select();
                document.execCommand('copy');
                alert('Referral link copied to clipboard!');
            });
            
            // Load referral stats (this would come from your backend API)
            loadReferralStats(telegramUserId);
        });
        
        // Mock function to get Telegram user ID
        function getTelegramUserId() {
            // In a real implementation, this would come from Telegram WebApp.initData
            // For demo purposes, we'll use a random ID
            return Math.floor(100000 + Math.random() * 900000);
        }
        
        // Mock function to load referral stats
        function loadReferralStats(userId) {
            // In a real implementation, you would fetch this from your backend
            // which would get the data from your database
            
            // Mock data for demonstration
            const mockData = {
                totalReferrals: 12,
                earnedMiko: 1200,
                referrals: [
                    { id: 1, username: 'user1', date: '2023-05-15', status: 'Active' },
                    { id: 2, username: 'user2', date: '2023-05-16', status: 'Active' },
                    { id: 3, username: 'user3', date: '2023-05-17', status: 'Active' },
                    { id: 4, username: 'user4', date: '2023-05-18', status: 'Active' },
                    { id: 5, username: 'user5', date: '2023-05-19', status: 'Active' },
                    { id: 6, username: 'user6', date: '2023-05-20', status: 'Active' },
                    { id: 7, username: 'user7', date: '2023-05-21', status: 'Active' },
                    { id: 8, username: 'user8', date: '2023-05-22', status: 'Active' },
                    { id: 9, username: 'user9', date: '2023-05-23', status: 'Active' },
                    { id: 10, username: 'user10', date: '2023-05-24', status: 'Active' },
                    { id: 11, username: 'user11', date: '2023-05-25', status: 'Active' },
                    { id: 12, username: 'user12', date: '2023-05-26', status: 'Active' }
                ]
            };
            
            // Update stats
            document.getElementById('totalReferrals').textContent = mockData.totalReferrals;
            document.getElementById('earnedMiko').textContent = mockData.earnedMiko;
            
            // Update referral list
            const referralList = document.getElementById('referralList');
            referralList.innerHTML = '';
            
            if (mockData.referrals.length === 0) {
                referralList.innerHTML = '<div class="no-referrals">No referrals yet. Share your link to earn!</div>';
            } else {
                mockData.referrals.forEach(referral => {
                    const item = document.createElement('div');
                    item.className = 'referral-item';
                    item.innerHTML = `
                        <span>@${referral.username}</span>
                        <span>${referral.date}</span>
                    `;
                    referralList.appendChild(item);
                });
            }
            
            // In a real implementation, you would use fetch() to get actual data:
            /*
            fetch(`/api/referrals?userId=${userId}`)
                .then(response => response.json())
                .then(data => {
                    // Update the UI with real data
                });
            */
        }
    </script>
</body>
</html>